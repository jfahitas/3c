<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Change Facilitation Toolkit</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #0f0515;
            --panel-bg: rgba(255, 255, 255, 0.04);
            --border-color: rgba(255, 255, 255, 0.1);
            --text-color: #e0e0e0;
            --text-muted: rgba(255, 255, 255, 0.6);
            --accent-color: #ffb3b3;
            --brand-color: #500000;
            --success-color: #2ecc71;
            --warning-color: #f1c40f;
            --error-color: #e74c3c;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: radial-gradient(ellipse at top, #0f0515 0%, #1a0a1a 30%, #2d1b2e 70%, #0f0515 100%);
            color: var(--text-color);
            line-height: 1.6;
        }

        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        .header-section {
            text-align: center;
            margin-bottom: 2rem;
        }

        .main-title {
            font-size: clamp(28px, 5vw, 42px);
            font-weight: 600;
            background: linear-gradient(135deg, #ffffff, var(--accent-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .main-subtitle {
            font-size: 18px;
            color: var(--text-muted);
        }

        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeInUp 0.5s; }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .scenario-selection-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }
        .scenario-card {
            background: var(--panel-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .scenario-card:hover {
            transform: translateY(-5px);
            background: rgba(80, 0, 0, 0.3);
            border-color: var(--accent-color);
        }
        .scenario-card h3 { color: var(--accent-color); margin-bottom: 0.5rem; }

        .phase-header {
            text-align: center;
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: rgba(80, 0, 0, 0.2);
            border-radius: 16px;
        }
        .phase-title { font-size: 1.5rem; font-weight: 600; color: #fff; }
        .phase-description { color: var(--text-muted); }

        .main-layout {
            display: grid;
            grid-template-columns: 1fr 320px;
            gap: 2rem;
        }

        .decision-panel {
            background: var(--panel-bg);
            border-radius: 16px;
            padding: 2rem;
        }
        
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }
        .sidebar-section {
            background: var(--panel-bg);
            border-radius: 16px;
            border: 1px solid var(--border-color);
            padding: 1.5rem;
        }
        .sidebar-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--accent-color);
            margin-bottom: 1rem;
        }
        .sidebar-content ul {
            list-style: none;
            padding-left: 0;
        }
        .sidebar-content li {
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }
        
        .progress-meter {
            margin-bottom: 1rem;
        }
        .progress-label {
            font-size: 0.9rem;
            margin-bottom: 0.25rem;
            color: var(--text-muted);
        }
        .meter-bar {
            width: 100%;
            height: 10px;
            background: rgba(0,0,0,0.3);
            border-radius: 5px;
            overflow: hidden;
        }
        .meter-fill {
            height: 100%;
            width: 50%;
            border-radius: 5px;
            transition: width 0.5s ease;
        }
        #transition-fill { background: var(--success-color); }
        #resistance-fill { background: var(--error-color); }
        #adoption-fill { background: #80d8ff; }

        .stakeholder-dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }
        .stakeholder-status {
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            padding: 1rem;
            text-align: center;
        }
        .stakeholder-name { font-weight: 600; margin-bottom: 0.5rem; }
        .stakeholder-stage {
            font-size: 0.8rem;
            font-weight: 600;
            padding: 0.2rem 0.6rem;
            border-radius: 20px;
            display: inline-block;
            transition: all 0.5s ease;
        }
        .stage-ending { background: var(--error-color); color: #fff; }
        .stage-neutral { background: var(--warning-color); color: #5c4100; }
        .stage-beginning { background: var(--success-color); color: #fff; }

        .choice-option {
            background: var(--panel-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem;
            cursor: pointer;
            margin-bottom: 1rem;
            transition: all 0.2s ease;
        }
        .choice-option:hover {
            border-color: var(--accent-color);
            background: rgba(80, 0, 0, 0.3);
        }
        .choice-option.disabled {
            opacity: 0.6;
            pointer-events: none;
        }

        .btn {
            padding: 12px 25px; border: none; border-radius: 10px; cursor: pointer;
            font-weight: 600; font-size: 14px; transition: all 0.3s ease;
            width: 100%;
        }
        .btn-primary {
            background: linear-gradient(135deg, #2ecc71, #27ae60); color: white;
        }
        .btn-secondary {
            background: rgba(255, 255, 255, 0.08); color: rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.15);
        }

        .results-panel { display: none; }
        .results-panel.show { display: block; }
        
        .feedback-section { background: rgba(255, 255, 255, 0.04); border-radius: 14px; padding: 20px; text-align: center; }
        .feedback-title { font-size: 1.5rem; font-weight: 600; color: var(--accent-color); margin-bottom: 12px; }
        .final-score { font-size: 3rem; font-weight: 700; color: var(--success-color); margin-bottom: 1rem; }
        .next-step-section { text-align: center; margin-top: 30px; }
        
        .choice-feedback {
            margin-top: 1.5rem;
            padding: 1rem;
            border-radius: 8px;
            background: rgba(0,0,0,0.2);
            animation: fadeIn 0.5s;
        }
        .feedback-item { margin-bottom: 1rem; }
        .feedback-item:last-child { margin-bottom: 0; }
        .feedback-item h5 {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }
        .feedback-item p {
            font-size: 0.9rem;
            color: var(--text-muted);
        }
        .optimal-choice h5 { color: var(--success-color); }
        .your-choice h5 { color: var(--error-color); }

        @media (max-width: 900px) {
            .main-layout { grid-template-columns: 1fr; }
            .sidebar { order: -1; }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <header class="header-section">
            <h1 class="main-title">Change Facilitation Toolkit</h1>
            <p class="main-subtitle">Guiding Teams Through Transition</p>
        </header>

        <div id="main-view">
            <div id="intro" class="tab-content active">
                <h2 style="color: #ffb3b3; margin-bottom: 10px; text-align: center;">Welcome!</h2>
                <p style="text-align: center; color: var(--text-muted); margin-bottom: 20px;">Select a scenario to practice your change facilitation skills.</p>
                <div class="scenario-selection-grid"></div>
            </div>

            <div id="scenario" class="tab-content">
                <!-- Scenario content will be injected here -->
            </div>

            <div id="results" class="tab-content results-panel">
                <div class="phase-header" style="text-align:center;">
                    <h2 class="phase-title">Change Debrief</h2>
                </div>
                <div class="feedback-section">
                    <h3 class="feedback-title" id="final-title">Great Effort!</h3>
                    <p>Your final facilitation effectiveness score is:</p>
                    <div class="final-score" id="final-score-value">--</div>
                    <div id="final-feedback" style="text-align: left;"></div>
                </div>
                <div class="next-step-section">
                    <button class="btn btn-secondary" id="backToMenuBtn">Back to Scenarios</button>
                </div>
            </div>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const scenarioContainer = document.getElementById('scenario');
            const introContainer = document.getElementById('intro');
            const resultsContainer = document.getElementById('results');

            let scores;
            let currentScenario;
            let currentPhaseIndex;

            const scenarios = [
                {
                    title: "Technology Change Without IT Authority",
                    situation: "A new software is being rolled out by IT. Your role is to help your peers adapt without any formal authority over the rollout.",
                    stakeholders: [
                        { name: "Tech-Fearful Peers", stage: 0 }, // 0: Ending, 1: Neutral, 2: Beginning
                        { name: "Long-time Employees", stage: 0 },
                        { name: "Early Adopters", stage: 1 }
                    ],
                    phases: [
                        {
                            challenge: "Initial rollout has begun. There is widespread fear and confusion among your peers.",
                            choices: [
                                { text: "Tell everyone to just read the manual provided by IT.", effects: { resistance: 10, adoption: -10, coalition: -5, stages: {} }, rationale: "This approach is dismissive of their fears and adds to their cognitive load, likely increasing resistance." },
                                { text: "Facilitate peer-to-peer learning sessions where early adopters can teach the basics.", effects: { resistance: -10, adoption: 15, coalition: 10, stages: { "Early Adopters": 2, "Tech-Fearful Peers": 1 } }, isOptimal: true, rationale: "This is optimal because it builds psychological safety, creates a support network (coalition), and provides practical help." },
                                { text: "Complain about the new software along with your colleagues to build rapport.", effects: { resistance: 15, adoption: -15, coalition: -10, stages: {} }, rationale: "While it might create temporary rapport, it validates resistance and undermines the entire change effort." }
                            ]
                        },
                        {
                            challenge: "Long-time employees are actively resisting, stating the old system was better and refusing to use the new one.",
                            choices: [
                                { text: "Report the resistant employees to their supervisors.", effects: { resistance: 20, adoption: 5, coalition: -15, stages: {} }, rationale: "Using authority escalates the conflict and creates a culture of fear, damaging your ability to influence as a peer." },
                                { text: "Acknowledge their frustration and collaborate with them to create a 'translation guide' from the old system to the new one.", effects: { resistance: -15, adoption: 10, coalition: 5, stages: { "Long-time Employees": 1 } }, isOptimal: true, rationale: "This is the best choice. It respects their experience, addresses their loss, and gives them a productive role in the transition." },
                                { text: "Ignore their resistance and focus only on the employees who are willing to change.", effects: { resistance: 10, adoption: -5, coalition: -5, stages: {} }, rationale: "This allows a pocket of resistance to grow and potentially sabotage the change, while also alienating experienced staff." }
                            ]
                        }
                    ]
                },
                {
                    title: "Process Change Across Departments",
                    situation: "A new workflow is being implemented that affects your department and two others you work closely with.",
                    stakeholders: [
                        { name: "Your Department", stage: 1 },
                        { name: "Dept. A (Losing Autonomy)", stage: 0 },
                        { name: "Dept. B (Unclear Role)", stage: 1 }
                    ],
                    phases: [
                        {
                            challenge: "Department A is angry about losing control over their part of the process.",
                            choices: [
                                { text: "Facilitate a dialogue session to map the new process together and clarify how their expertise is still critical.", effects: { resistance: -15, adoption: 10, coalition: 10, stages: { "Dept. A (Losing Autonomy)": 1 } }, isOptimal: true, rationale: "This is optimal as it addresses their sense of loss directly, respects their expertise, and gives them agency in the new process." },
                                { text: "Communicate that the change is mandatory and they need to comply.", effects: { resistance: 15, adoption: -10, coalition: -10, stages: {} }, rationale: "This relies on authority you don't have, increasing resistance and damaging cross-departmental relationships." },
                                { text: "Coordinate a meeting with leadership to enforce the new process on Department A.", effects: { resistance: 20, adoption: -5, coalition: -15, stages: {} }, rationale: "Escalating the issue undermines your role as a facilitator and turns a process problem into a political one." }
                            ]
                        },
                        {
                            challenge: "Department B is confused about their new responsibilities and is becoming a bottleneck in the workflow.",
                            choices: [
                                { text: "Send them a detailed email explaining their new role.", effects: { resistance: 5, adoption: 5, coalition: 0, stages: {} }, rationale: "One-way communication is unlikely to resolve the confusion of the Neutral Zone. It lacks the interaction needed for true clarity." },
                                { text: "Create a cross-departmental 'win' by helping them solve a problem using the new process, demonstrating its value.", effects: { resistance: -10, adoption: 20, coalition: 15, stages: { "Dept. B (Unclear Role)": 2 } }, isOptimal: true, rationale: "This is the best choice. It creates a small win, demonstrates the benefit of the new process, and builds a collaborative relationship." },
                                { text: "Take over their tasks temporarily to keep the project moving.", effects: { resistance: 0, adoption: -15, coalition: -5, stages: {} }, rationale: "This solves the immediate problem but prevents Department B from learning, creating dependency and resentment." }
                            ]
                        }
                    ]
                },
                {
                    title: "Cultural Shift Toward Innovation",
                    situation: "Leadership is pushing for a culture of more innovation and risk-taking, but you have no formal authority to enforce it.",
                    stakeholders: [
                        { name: "Risk-Averse Peers", stage: 0 },
                        { name: "Curious Innovators", stage: 1 },
                        { name: "Middle Management", stage: 1 }
                    ],
                    phases: [
                        {
                            challenge: "Your peers are comfortable with the status quo and afraid to try new things for fear of failure.",
                            choices: [
                                { text: "Model safe experimentation by trying a small, low-risk innovation on your own work and sharing the results, whether it succeeds or fails.", effects: { resistance: -10, adoption: 10, coalition: 10, stages: { "Curious Innovators": 2 } }, isOptimal: true, rationale: "This is optimal. It demonstrates the desired behavior, creates psychological safety by sharing failures, and inspires others through action, not words." },
                                { text: "Forward leadership's emails about innovation to your team with an encouraging note.", effects: { resistance: -5, adoption: 5, coalition: 0, stages: {} }, rationale: "This is a low-impact action that does little to address the underlying fear of failure." },
                                { text: "Criticize the current lack of innovation in a team meeting to create a sense of urgency.", effects: { resistance: 15, adoption: -10, coalition: -10, stages: {} }, rationale: "This approach creates fear and defensiveness, making people less likely to take the risks required for innovation." }
                            ]
                        },
                        {
                            challenge: "Middle managers are paying lip service to innovation but still punishing small failures.",
                            choices: [
                                { text: "Build a coalition of other innovation champions and collectively present a proposal to leadership for 'safe-to-fail' experiments.", effects: { resistance: -5, adoption: 15, coalition: 20, stages: { "Middle Management": 2 } }, isOptimal: true, rationale: "This is the best choice. It uses influence to address a systemic issue, provides a concrete solution, and protects individuals by acting as a group." },
                                { text: "Go to your own boss and complain about the mixed messages from middle management.", effects: { resistance: 5, adoption: -5, coalition: -5, stages: {} }, rationale: "This positions you as a complainer rather than a problem-solver and may not lead to any real change." },
                                { text: "Encourage your team to innovate but warn them to be careful not to fail.", effects: { resistance: 10, adoption: -10, coalition: 0, stages: {} }, rationale: "This sends a conflicting message that reinforces the fear of failure, effectively stifling any real innovation." }
                            ]
                        }
                    ]
                }
            ];
            
            function renderScenario(scenarioId) {
                currentScenario = scenarios[scenarioId];
                currentScenario.stakeholders = JSON.parse(JSON.stringify(scenarios[scenarioId].stakeholders));
                currentPhaseIndex = 0;
                scores = { transition: 0, resistance: 50, adoption: 0, coalition: 50 };
                
                let stakeholderDashboardHTML = '';
                currentScenario.stakeholders.forEach(s => {
                    stakeholderDashboardHTML += `
                        <div class="stakeholder-status" data-name="${s.name}">
                            <div class="stakeholder-name">${s.name}</div>
                            <div class="stakeholder-stage"></div>
                        </div>
                    `;
                });

                scenarioContainer.innerHTML = `
                    <div class="phase-header">
                        <h3 class="phase-title">${currentScenario.title}</h3>
                    </div>
                    <div class="main-layout">
                        <div class="decision-panel" id="decision-panel"></div>
                        <aside class="sidebar">
                            <div class="sidebar-section">
                                <h3 class="sidebar-title">Change Progress</h3>
                                <div class="progress-meter">
                                    <div class="progress-label">Overall Transition</div>
                                    <div class="meter-bar"><div id="transition-fill" class="meter-fill"></div></div>
                                </div>
                                <div class="progress-meter">
                                    <div class="progress-label">Resistance Level</div>
                                    <div class="meter-bar"><div id="resistance-fill" class="meter-fill"></div></div>
                                </div>
                                <div class="progress-meter">
                                    <div class="progress-label">Adoption Rate</div>
                                    <div class="meter-bar"><div id="adoption-fill" class="meter-fill"></div></div>
                                </div>
                            </div>
                            <div class="sidebar-section">
                                <h3 class="sidebar-title">Stakeholder Dashboard</h3>
                                <div class="stakeholder-dashboard">${stakeholderDashboardHTML}</div>
                            </div>
                        </aside>
                    </div>
                `;
                
                updateMetrics();
                renderPhase();
            }

            function renderPhase() {
                const phase = currentScenario.phases[currentPhaseIndex];
                const decisionPanel = document.getElementById('decision-panel');
                
                let choicesHTML = '';
                phase.choices.forEach((choice, index) => {
                    choicesHTML += `<div class="choice-option" data-index="${index}"><p>${choice.text}</p></div>`;
                });

                decisionPanel.innerHTML = `
                    <h3 style="color: var(--accent-color); margin-bottom: 1rem;">Challenge: ${phase.challenge}</h3>
                    <p style="color: var(--text-muted); margin-bottom: 1.5rem;">Choose your intervention:</p>
                    ${choicesHTML}
                    <div id="choice-feedback" class="choice-feedback" style="display:none;"></div>
                `;

                document.querySelectorAll('.choice-option').forEach((btn, index) => {
                    btn.addEventListener('click', () => handleChoiceSelection(index));
                });
            }

            function handleChoiceSelection(choiceIndex) {
                const phase = currentScenario.phases[currentPhaseIndex];
                const selectedChoice = phase.choices[choiceIndex];
                const selectedChoiceElement = document.querySelector(`.choice-option[data-index="${choiceIndex}"]`);

                scores.resistance = Math.max(0, Math.min(100, scores.resistance + (selectedChoice.effects.resistance || 0)));
                scores.adoption = Math.max(0, Math.min(100, scores.adoption + (selectedChoice.effects.adoption || 0)));
                scores.coalition = Math.max(0, Math.min(100, scores.coalition + (selectedChoice.effects.coalition || 0)));
                
                Object.keys(selectedChoice.effects.stages).forEach(stakeholderName => {
                    const stakeholder = currentScenario.stakeholders.find(s => s.name === stakeholderName);
                    if (stakeholder) {
                        stakeholder.stage = selectedChoice.effects.stages[stakeholderName];
                    }
                });

                updateMetrics();
                
                document.querySelectorAll('.choice-option').forEach(btn => btn.classList.add('disabled'));

                const optimalChoice = phase.choices.find(c => c.isOptimal);
                
                const feedbackBox = document.getElementById('choice-feedback');
                let feedbackHTML = `<div class="feedback-item optimal-choice"><h5>Optimal Choice:</h5><p>${optimalChoice.rationale}</p></div>`;

                if (!selectedChoice.isOptimal) {
                    selectedChoiceElement.style.borderColor = 'var(--error-color)';
                    feedbackHTML += `<div class="feedback-item your-choice"><h5>Your Choice:</h5><p>${selectedChoice.rationale}</p></div>`;
                }
                document.querySelector(`.choice-option[data-index="${phase.choices.indexOf(optimalChoice)}"]`).style.borderColor = 'var(--success-color)';
                
                feedbackHTML += `<button class="btn btn-primary" id="continueBtn" style="margin-top: 1rem;">Continue</button>`;
                feedbackBox.innerHTML = feedbackHTML;
                feedbackBox.style.display = 'block';

                document.getElementById('continueBtn').addEventListener('click', () => {
                    currentPhaseIndex++;
                    if (currentPhaseIndex < currentScenario.phases.length) {
                        renderPhase();
                    } else {
                        showResults();
                    }
                });
            }

            function updateMetrics() {
                const totalStages = currentScenario.stakeholders.length * 2;
                const currentStageSum = currentScenario.stakeholders.reduce((acc, s) => acc + s.stage, 0);
                scores.transition = Math.round((currentStageSum / totalStages) * 100);

                document.getElementById('transition-fill').style.width = `${scores.transition}%`;
                document.getElementById('resistance-fill').style.width = `${scores.resistance}%`;
                document.getElementById('adoption-fill').style.width = `${scores.adoption}%`;

                const stageMap = ['Ending', 'Neutral', 'Beginning'];
                const classMap = ['stage-ending', 'stage-neutral', 'stage-beginning'];
                currentScenario.stakeholders.forEach(s => {
                    const el = document.querySelector(`.stakeholder-status[data-name="${s.name}"] .stakeholder-stage`);
                    el.textContent = stageMap[s.stage];
                    el.className = 'stakeholder-stage ' + classMap[s.stage];
                });
            }

            function showResults() {
                scenarioContainer.classList.remove('active');
                resultsContainer.classList.add('active');
                
                const finalScore = Math.round((scores.transition + (100 - scores.resistance) + scores.adoption + scores.coalition) / 4);
                const finalScoreEl = document.getElementById('final-score-value');
                const finalFeedbackEl = document.getElementById('final-feedback');
                const finalTitleEl = document.getElementById('final-title');

                finalScoreEl.textContent = `${finalScore} / 100`;
                
                if (finalScore >= 80) {
                    finalTitleEl.textContent = "Excellent!";
                    finalFeedbackEl.innerHTML = "<p>You masterfully guided your stakeholders through the transition, building momentum and ensuring successful adoption of the change.</p>";
                    finalScoreEl.style.color = 'var(--success-color)';
                } else if (finalScore >= 50) {
                    finalTitleEl.textContent = "Solid Performance!";
                    finalFeedbackEl.innerHTML = "<p>You made good progress in facilitating the change, but some stakeholder groups faced significant resistance or confusion. Focusing on the needs of those in the 'Ending' stage can help smooth future transitions.</p>";
                    finalScoreEl.style.color = 'var(--warning-color)';
                } else {
                    finalTitleEl.textContent = "Room for Improvement";
                    finalFeedbackEl.innerHTML = "<p>This was a challenging change to facilitate. Your interventions created significant resistance and lowered the adoption rate. Remember to meet people where they are in the transition process.</p>";
                    finalScoreEl.style.color = 'var(--error-color)';
                }
            }

            function startScenario(scenarioId) {
                introContainer.classList.remove('active');
                resultsContainer.classList.remove('active');
                scenarioContainer.classList.add('active');
                renderScenario(scenarioId);
            }
            
            function showIntro() {
                const grid = introContainer.querySelector('.scenario-selection-grid');
                grid.innerHTML = '';
                scenarios.forEach((scenario, index) => {
                    grid.innerHTML += `<div class="scenario-card" data-scenario-id="${index}"><h3>${scenario.title}</h3></div>`;
                });
                 document.querySelectorAll('.scenario-card').forEach(card => {
                    card.addEventListener('click', (e) => startScenario(parseInt(e.currentTarget.dataset.scenarioId)));
                });
            }

            document.getElementById('backToMenuBtn').addEventListener('click', () => {
                 resultsContainer.classList.remove('active');
                 introContainer.classList.add('active');
            });
            
            showIntro();
        });
    </script>
</body>
</html>
